<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width" , initial-scale="1">
    <title>포트폴리오</title>
    <link rel="stylesheet" href="css/bootstrap.css">
    <link rel="stylesheet" href="css/myStyle.css">
    <style type="text/css">
        .jumbotron {
            background-image: url('images/bonobono.jpg');
            background-size: cover;
            text-shadow: black 0.2em 0.2em 0.2em;
            color: white;
        }

        .dropdown:hover > .dropdown-menu {
            display: block;
        }

        .main-area {
            border: 1px solid #ccc;
            border-radius: 10px;
        }
    </style>
</head>
<body>
<nav class="navbar navbar-default">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed"
                    data-toggle="collapse" data-target="#bs-example-navber-collapse-1"
                    aria-expanded="false">
                <span class="sr-only"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand">모여모여게시판</a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active" id="portfolioBtn"><a>포트폴리오<span class="sr-only"></span></a></li>
                <li class="active" id="boardBtn"><a>게시판<span class="sr-only"></span></a></li>
            </ul>
            <ul class="nav navbar-nav pull-right">
                <li class="active" id="logoutBtn"><a>로그아웃<span class="sr-only"></span></a></li>
                <li class="active" id="myPageBtn"><a>마이페이지<span class="sr-only"></span></a></li>
            </ul>
        </div>
    </div>
</nav>
<div class="container">
    <div class="container">
        <div class="jumbotron">
            <h1 class="text-center">포트폴리오</h1>
            <p class="text-center"> 프로젝트의 거대한 도우미</p>
        </div>
    </div>
    <div class="container main-area">
        <h3>완료한 프로젝트</h3>
        <form>
            <div class="row">
                <div class="col-md-12">
                    <div class="">
                        <div class="table">
                            <table class="table table-hover results">
                                <thead>
                                <tr>
                                    <th class="col-md-1">번호</th>
                                    <th class="col-md-4">제목</th>
                                    <th class="col-sm-2">종료일시</th>
                                    <th class="col-md-2">주최자</th>
                                    <th class="col-md-2">인원</th>
                                </tr>
                                </thead>
                                <tbody id="completedProjects">
                                <tr>
                                    <td>1</td>
                                    <td class="dropdown"><a href="">게임만들기</a>
                                        <a class="dropdown-toggle pull-right"
                                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                            게임만들기에 대한 간단한 설명입니다 이건 게임을 만드는 프로젝트에요
                                        </div>
                                    </td>
                                    <td>2020/04/27</td>
                                    <td>고재우</td>
                                    <td class="dropdown">4/5
                                        <a class="dropdown-toggle pull-right"
                                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            ▽
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                                            개발자 3 / 4
                                            <br>
                                            기획자 1 / 1
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
    &nbsp;
    <div class="container ">
        <form>
            <div class="row">
                <div class="main-area col-md-6">
                    <h3>자격증</h3>
                    <button class="pull-right">삭제</button>
                    <div class="">
                        <div class="table">
                            <table class="table table-hover results">
                                <thead>
                                <tr>
                                    <th class="col-sm-1">no.</th>
                                    <th class="col-sm-4">이름</th>
                                    <th class="col-sm-2">분야</th>
                                    <th class="col-sm-2">취득일시</th>
                                    <th class="col-sm-offset-1 col-sm-1">선택</th>
                                </tr>
                                </thead>
                                <tbody id="certificate">
                                <tr>
                                    <td>1</td>
                                    <td class="dropdown">전문 잠자기 자격증</td>
                                    <td>수면</td>
                                    <td class="dropdown"> 1996/04/27</td>
                                    <td><input class="" type="checkbox"></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class=" col-lg-4">
                        <input class="form-control input-sm" type="text" placeholder="제목">
                    </div>
                    <div class=" col-lg-2">
                        <input class="form-control input-sm" type="text" placeholder="분야">
                    </div>
                    <div class=" col-lg-4">
                        <input class="form-control input-sm" type="date">
                    </div>
                    <div class=" col-sm-2">
                        <button type="button" class="btn btn-primary btn-sm " id="">추가</button>
                    </div>
                </div>
                <div class=" main-area col-sm-offset-1 col-md-5">
                    <h3>수상경력</h3>
                    <button class="pull-right">삭제</button>
                    <div class="">
                        <div class="table">
                            <table class="table table-hover results">
                                <thead>
                                <tr>
                                    <th class="col-sm-1">no.</th>
                                    <th class="col-sm-4">제목</th>
                                    <th class="col-sm-2">분야</th>
                                    <th class="col-sm-2">수상일시</th>
                                    <th class="col-sm-offset-1 col-sm-1">선택</th>
                                </tr>
                                </thead>
                                <tbody id="awards">
                                <tr>
                                    <td>1</td>
                                    <td class="dropdown">잠자기 대회</td>
                                    <td>수면</td>
                                    <td class="dropdown">2020/04/27</td>
                                    <td><input class="" type="checkbox"></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class=" col-lg-4">
                        <input class="form-control input-sm" type="text" placeholder="제목">
                    </div>
                    <div class=" col-lg-2">
                        <input class="form-control input-sm" type="text" placeholder="분야">
                    </div>
                    <div class=" col-lg-4">
                        <input class="form-control input-sm" type="date">
                    </div>
                    <div class=" col-sm-2">
                        <button type="button" class="btn btn-primary btn-sm " id="n">추가</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="js/bootstrap.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
<script src="js/myLibrary.js"></script>
<script>
	const completedProjects = $('#completedProjects');
	const certificate = $('#certificate');
	const awards = $('#awards');
	const createBtn = $('#createBtn');

	async function init() {
		completedProjects.empty();

		try {
			await $.get(getAjaxObject('./api/user/'));
			const projectObjs = await $.get(getAjaxObject(`./api/project/list/complete`));

			// 프로젝트 목록
            let projectIndex = 1;
			projectObjs.map((projectObj) => {
				const presentNumbers = {}, allNumbers = {};
				const [presentNumber , allNumber] = getMemberNumbers(projectObj, presentNumbers, allNumbers, 0);
				let item = `<tr><td>${projectIndex++}</td><td class="dropdown">` +
					`<a href="./project.html?no=${projectObj.project.no}&check=y&complete=y">${projectObj.project.title}</a>` +
					'<a class="dropdown-toggle pull-right" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></a>' +
					`<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">${projectObj.project.content}</div></td>` +
                    `<td>${new Date(projectObj.project.completedTime).format('yyyy-MM-dd')}</td><td>${projectObj.project.organizer.nickname}</td>` +
					`<td class="dropdown">${presentNumber} / ${allNumber}` +
					'<span class="pull-right">▽</span>' +
					'<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">';

				for (let field in allNumbers) {
					item += `${field} ${presentNumbers[field]} / ${allNumbers[field]}<br>`;
				}

				completedProjects.append(item.substr(0, item.length - 4) + '</div></td></tr>');
			});
		}
		catch (e) {
			alert('세션이 만료되었습니다.');
			window.location = './signIn.html';
		}

		createBtn.on('click', (e) => window.location = './createProject.html');
	}

	init();
</script>
</body>
</html>
